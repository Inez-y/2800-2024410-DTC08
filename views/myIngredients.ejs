<%- include("templates/htmlDocHeader") %>
<%- include("templates/header") %>

<main class="flex flex-col items-center justify-center h-screen" style="max-height: 75vh;">
    <div class="p-4 m-5 max-w-xs rounded-3xl bg-gray-100 relative">
        <div class="flex justify-center">
            <button class="m-2 rounded-full bg-buttongreen text-white" id="myCookbookButton"><a href="/Cookbook">My Cookbook</a></button>
            <button class="m-2 rounded-full bg-buttongreen text-white" id="myIngredientsButton"><a href="/myIngredients">My Ingredients</a></button>
        </div>

        <div class="text-left text-4xl p-2 m-2 font-bold">My Ingredients</div>
        <div class="max-w-s">
            <div class="relative bg-gray-100 rounded-lg p-4 shadow-md" style="max-height: 60vh; overflow-y: auto;">
                <ul id="ingredients-list" class="space-y-2">
                    <% for (let i = 0; i < ingredients.length; i++) { %>
                        <li class="bg-white shadow-md rounded mb-4 p-4 flex flex-col justify-between items-start">
                            <div class="w-24 items-center">
                                <div class="ingredient-details">
                                    <div class="text-xl font-bold"><input type="text" class="ingredient-name bg-white" value="<%= ingredients[i].name %>" disabled style="width:200px;"></div>
                                    <div class="text-gray-700">
                                        <input type="number" class="ingredient-amount bg-white" value="<%= ingredients[i].amount %>" disabled> 
                                        <input type="text" class="ingredient-unit bg-white" value="<%= ingredients[i].unit %>" disabled>
                                    </div>
                                </div>
                                <button class="delete-ingredient bg-buttongreen text-black rounded px-3 py-1" data-id="<%= ingredients[i]._id %>" style="margin-top:10px;">Delete</button>
                            </div>
                        </li>
                    <% } %>
                </ul>
            </div>
        </div>
    </div>
</main>

<%- include("templates/footer") %>

<script>
document.querySelectorAll('.delete-ingredient').forEach(button => {
    button.addEventListener('click', async () => {
        const id = button.getAttribute('data-id');
        
        const response = await fetch(`/delete-ingredient/${id}`, {
            method: 'DELETE'
        });

        if (response.ok) {
            location.reload();
        } else {
            alert('Failed to delete ingredient. Please try again.');
        }
    });
});
</script>
</body>
</html>
